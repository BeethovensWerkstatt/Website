---
layout: default
---

<article class="glossary-term">
  <header class="glossary-header">
    <h1 class="glossary-title">{{ page.title | escape }}</h1>
    {% if page.author %}
      <p class="glossary-meta">
        von {{ page.author }}{% if page.version %} | Version {{ page.version }}{% endif %}{% if page.date %} | {{ page.date | date: "%d.%m.%Y" }}{% endif %}
      </p>
    {% endif %}
  </header>

  {% comment %}Check versions of this article{% endcomment %}
  {% assign current_version = page.version %}
  {% assign newer_version_found = false %}
  {% assign newer_url = '' %}
  {% assign newer_version = '' %}
  {% assign older_versions_array = '' | split: ',' %}
  
  {% for glossary_page in site.glossary %}
    {% if glossary_page.url contains '/glossar/' %}
      {% if glossary_page.title == page.title and glossary_page.version and glossary_page.version != current_version %}
        {% comment %}Found a related version{% endcomment %}
        {% if glossary_page.version > current_version %}
          {% assign newer_version_found = true %}
          {% assign newer_url = glossary_page.url %}
          {% assign newer_version = glossary_page.version %}
        {% else %}
          {% assign older_versions_array = older_versions_array | push: glossary_page %}
        {% endif %}
      {% endif %}
    {% endif %}
  {% endfor %}

  {% comment %}Show disclaimer for archived versions at top{% endcomment %}
  {% if newer_version_found %}
    <div class="version-notice archived">
      <strong>Archivierte Version:</strong> Dies ist Version {{ current_version }} dieses Artikels.
      <br><a href="{{ newer_url }}">Zur aktuellen Version {{ newer_version }}</a>
      <br><small>Diese Version wird zu Archivierungszwecken und für wissenschaftliche Zitate beibehalten.</small>
    </div>
  {% endif %}

  <div class="glossary-content">
    {{ content }}
  </div>

</article>

<style>
.version-notice {
  padding: 1rem 1.25rem !important;
  margin: 1.5rem 0 2rem 0 !important;
  border-radius: 0 8px 8px 0 !important;
  font-size: 0.9em !important;
  border: 1px solid !important;
  border-left: 4px solid !important;
}

.version-notice.archived {
  background: linear-gradient(135deg, #fff3cd 0%, #fef8e7 100%) !important;
  border-color: #ffeaa7 !important;
  border-left-color: #f39c12 !important;
  box-shadow: 0 2px 8px rgba(243, 156, 18, 0.1) !important;
}

.version-notice.archived strong {
  color: #d68910 !important;
  font-weight: 600 !important;
}

.version-notice.current {
  background: linear-gradient(135deg, #d1ecf1 0%, #e7f3ff 100%) !important;
  border-color: #bee5eb !important;
  border-left-color: #17a2b8 !important;
  box-shadow: 0 2px 8px rgba(23, 162, 184, 0.1) !important;
}

.version-notice.current strong {
  color: #0c5460 !important;
  font-weight: 600 !important;
}

.version-notice a {
  color: #c93b22 !important;
  text-decoration: none !important;
  font-weight: 500 !important;
}

.version-notice a:hover {
  text-decoration: underline !important;
  color: #a12e1a !important;
}

.version-notice.archived small {
  color: #856404 !important;
  font-style: italic !important;
}

.version-notice.current small {
  color: #0c5460 !important;
  font-style: italic !important;
}

article.glossary-term .glossary-content img {
  max-width: 100% !important;
  height: auto !important;
  display: block !important;
  margin: 1.5rem auto !important;
  border: 1px solid #dee2e6 !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
}

article.glossary-term .glossary-content img.inline-image {
  display: inline !important;
  max-width: none !important;
  height: 1.2em !important;
  width: auto !important;
  margin: 0 0.2em !important;
  border: none !important;
  box-shadow: none !important;
  vertical-align: baseline !important;
}

/* Image caption styling - for em elements that follow images */
article.glossary-term .glossary-content p img + em,
article.glossary-term .glossary-content p:has(img) + p em,
article.glossary-term .glossary-content figure em {
  display: block !important;
  text-align: center !important;
  font-style: normal !important;
  color: #495057 !important;
  font-size: 0.85em !important;
  background-color: #f8f9fa !important;
  padding: 0.75rem 1rem !important;
  border-left: 3px solid #c93b22 !important;
  border-radius: 0 4px 4px 0 !important;
  max-width: 90% !important;
  margin: 0.5rem auto 1.5rem auto !important;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1) !important;
}

/* Alternative: Use a specific class for image captions */
article.glossary-term .glossary-content em.caption {
  display: block !important;
  text-align: center !important;
  font-style: normal !important;
  color: #495057 !important;
  font-size: 0.85em !important;
  background-color: #f8f9fa !important;
  padding: 0.75rem 1rem !important;
  border-left: 3px solid #c93b22 !important;
  border-radius: 0 4px 4px 0 !important;
  max-width: 90% !important;
  margin: 0.5rem auto 1.5rem auto !important;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1) !important;
}

/* Normal italic text should stay italic */
article.glossary-term .glossary-content p em {
  font-style: italic !important;
}

article.glossary-term .glossary-content p em a {
  color: #c93b22 !important;
  text-decoration: underline !important;
}
</style>

  <footer class="glossary-footer">
    <!-- Categories and Related Terms Section -->
    {% assign current_term = page.title | downcase %}
    
    {% comment %}
    Erzeuge eine Liste mit nur den neuesten Versionen aller Glossareinträge:
    - Gruppiere Artikel nach Titel
    - Wähle nur die neueste Version jedes Artikels aus
    - Schließe die aktuelle Seite aus
    {% endcomment %}
    {% assign all_terms = site.glossary | group_by: "title" %}
    {% assign latest_terms = "" | split: "," %}
    {% for group in all_terms %}
      {% unless group.name == page.title %}
        {% assign latest_version = group.items | sort: "version" | last %}
        {% assign latest_terms = latest_terms | push: latest_version %}
      {% endunless %}
    {% endfor %}
    
    {% assign matching_terms = "" | split: "," %}
    
    {% comment %}
    Durchsuche alle anderen Glossareinträge nach dem aktuellen Begriff:
    - Konvertiere Seiteninhalt zu Kleinbuchstaben für case-insensitive Suche
    - Prüfe ob der aktuelle Begriff (z.B. "ähnlichkeit") im Text enthalten ist
    - Füge passende Begriffe zur matching_terms Liste hinzu
    Performance-Hinweis: Bei vielen Einträgen (>100) kann dies die Build-Zeit verlängern (Optimierungsmöglichkeiten bei Bedarf prüfen)
    {% endcomment %}
    {% for term in latest_terms %}
      {% assign term_content = term.content | downcase %}
      {% if term_content contains current_term %}
        {% assign matching_terms = matching_terms | push: term %}
      {% endif %}
    {% endfor %}

    {% if page.categories and page.categories.size > 0 or matching_terms.size > 0 %}
      <div class="term-info-section">
        {% if page.categories and page.categories.size > 0 %}
          <div class="term-category">
            <h4>{{ page.title }} <span class="muted-text">wurde entwickelt in:</span></h4>
            {% for category in page.categories %}
              {% assign module_url = category | downcase | replace: ' ', '-' %}
              <a href="/{{ module_url }}/" class="category-tag-link">
                <span class="category-tag">{{ category }}</span>
              </a>{% unless forloop.last %}, {% endunless %}
            {% endfor %}
          </div>
        {% endif %}

        {% comment %}
        Analysiere ausgehende Links im aktuellen Artikel:
        - Extrahiere alle Jekyll-Links vom Format {% link _glossary/[dateiname].md %}
        - Zähle die Links und sammle die Ziel-Artikel
        {% endcomment %}
        {% assign outgoing_links = "" | split: "," %}
        <!-- Suche nach URLs statt Dateipfaden -->
        {% assign link_count = 0 %}
        {% assign content_str = content | strip %}
        
        {% comment %}Suche nach generierten URLs{% endcomment %}
        {% assign glossary_files = site.glossary %}
        {% for glossary_term in glossary_files %}
          {% assign term_url = glossary_term.url | relative_url %}
          
          {% if content_str contains term_url %}
            {% if glossary_term.title != page.title %}
              {% assign outgoing_links = outgoing_links | push: glossary_term %}
              {% assign link_count = link_count | plus: 1 %}
            {% endif %}
          {% endif %}
        {% endfor %}

        {% if outgoing_links.size > 0 %}
          <div class="outgoing-links">
            <h4>{{ page.title }} <span class="muted-text">verweist auf {{ outgoing_links.size }} {% if outgoing_links.size == 1 %}Glossarbeitrag{% else %}Glossarbeiträge{% endif %}:</span></h4>
            
            <div class="outgoing-links-compact">
              {% for term in outgoing_links %}
                <a href="{{ term.url | relative_url }}" class="outgoing-link"><strong>{{ term.title }}</strong></a>{% unless forloop.last %}, {% endunless %}
              {% endfor %}
            </div>
          </div>
        {% endif %}

        {% if matching_terms.size > 0 %}
          <div class="related-terms">
            <h4>{{ page.title }} <span class="muted-text">wird verwendet in {{ matching_terms.size }} {% if matching_terms.size == 1 %}Glossarbeitrag{% else %}Glossarbeiträgen{% endif %}:</span></h4>
            
            <div class="related-terms-compact">
              {% for term in matching_terms %}
                {% assign term_slug = term.url | remove: '/glossar/' | split: '/' | first %}
                <a href="/glossar/{{ term_slug }}/" class="related-term-link"><strong>{{ term.title }}</strong></a>{% unless forloop.last %}, {% endunless %}
              {% endfor %}
            </div>
          </div>
        {% endif %}
      </div>
    {% endif %}
    {% if page.doi_article or page.doi_version or page.doi_overview %}
      <div class="citation-box">
        <h3>Zitierhinweis</h3>
        <div class="citation-content">
          <p><strong>{{ page.author }}:</strong> „{{ page.title }}"{% if page.version %}, Version {{ page.version }}{% endif %}{% if page.date %} ({{ page.date | date: "%d.%m.%Y" }}){% endif %}, in: Beethovens Werkstatt - Glossar, <a href="https://beethovens-werkstatt.de{{ page.url }}" target="_blank">https://beethovens-werkstatt.de{{ page.url }}</a></p>
          
          {% if page.doi_version or page.doi_overview %}
            <div class="doi-links">
              {% if page.doi_version %}
                <p>DOI der Version {{ page.version }}: <a href="https://doi.org/{{ page.doi_version }}" target="_blank">{{ page.doi_version }}</a></p>
              {% endif %}
              {% if page.doi_overview %}
                <p>DOI aller Versionen: <a href="https://doi.org/{{ page.doi_overview }}" target="_blank">{{ page.doi_overview }}</a></p>
              {% endif %}
            </div>
          {% endif %}
        </div>
      </div>
    {% endif %}

    {% comment %}Show disclaimer for current versions after citation{% endcomment %}
    {% if older_versions_array.size > 0 %}
      <div class="version-notice current">
        <strong>Aktuelle Version:</strong> Dies ist die neueste Version ({{ current_version }}) dieses Artikels.
        <br>Frühere Versionen: 
        {% for old_version in older_versions_array %}
          <a href="{{ old_version.url }}">{{ old_version.version }}</a>{% unless forloop.last %}, {% endunless %}
        {% endfor %}
        <br><small>Alle Versionen bleiben für wissenschaftliche Referenzen verfügbar.</small>
      </div>
    {% endif %}

    {% if page.tags and page.tags.size > 0 %}
      <div class="glossary-tags">
        <strong>Schlagwörter:</strong>
        {% for tag in page.tags %}
          <span class="tag">{{ tag }}</span>{% unless forloop.last %}, {% endunless %}
        {% endfor %}
      </div>
    {% endif %}
  </footer>
</article>

<style>
/* Glossary-specific styling */
.glossary-term {
  max-width: 800px;
  margin: 0 auto;
  padding: 2rem;
}

.glossary-header {
  border-bottom: 2px solid #c93b22;
  padding-bottom: 1rem;
  margin-bottom: 2rem;
}

.glossary-title {
  color: #c93b22;
  font-size: 2.5em;
  margin-bottom: 0.5rem;
}

.glossary-meta {
  color: #666;
  font-style: italic;
  margin: 0;
}

.glossary-content {
  line-height: 1.7;
  font-size: 1.1em;
}

.glossary-content p {
  margin-bottom: 1.5rem;
  text-align: justify;
}

.glossary-content h2 {
  color: #c93b22;
  margin-top: 2.5rem;
  margin-bottom: 1rem;
  border-bottom: 1px solid #ddd;
  padding-bottom: 0.5rem;
}

/* Term Info Section */
.term-info-section {
  background: #fff;
  border: 2px solid #c93b22;
  border-radius: 8px;
  padding: 1.5rem;
  margin-bottom: 2rem;
}

.term-category {
  margin-bottom: 1.5rem;
}

.related-terms {
  border-top: 1px solid #e0d6d5;
  padding-top: 1.5rem;
}

.outgoing-links {
  border-top: 1px solid #e0d6d5;
  padding-top: 1.5rem;
  margin-bottom: 1.5rem;
}

.term-category h4,
.related-terms h4,
.outgoing-links h4 {
  color: #333;
  margin: 0 0 0.8rem 0;
  font-size: 1.1em;
  font-weight: bold;
}

.muted-text {
  color: #666;
  font-weight: normal;
}

.related-description {
  color: #666;
  font-size: 0.9em;
  margin-bottom: 1rem;
  font-style: italic;
}

.related-terms-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 0.8rem;
}

.related-terms-compact,
.outgoing-links-compact {
  line-height: 1.6;
  margin-top: 0.8rem;
}

.related-term-link,
.outgoing-link {
  color: #c93b22;
  text-decoration: none;
  font-weight: 500;
}

.related-term-link:hover,
.outgoing-link:hover {
  text-decoration: underline;
  color: #a12e1a;
}

.more-terms {
  margin-top: 1rem;
  border-top: 1px solid #e0d6d5;
  padding-top: 1rem;
}

.more-terms summary {
  color: #c93b22;
  cursor: pointer;
  font-weight: 500;
  margin-bottom: 0.8rem;
}

.more-terms summary:hover {
  color: #a12e1a;
}

.related-term-card {
  display: block;
  background: white;
  border: 1px solid #e0d6d5;
  border-radius: 5px;
  padding: 0.8rem;
  text-decoration: none;
  color: #333;
  transition: all 0.2s ease;
}

.related-term-card:hover {
  background: #c93b22;
  color: white;
  text-decoration: none;
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(201, 59, 34, 0.2);
}

.related-term-card strong {
  display: block;
  color: #c93b22;
  margin-bottom: 0.3rem;
}

.related-term-card:hover strong {
  color: white;
}

.term-module {
  font-size: 0.8em;
  color: #888;
}

.related-term-card:hover .term-module {
  color: #fff;
}

.glossary-footer {
  margin-top: 3rem;
  padding-top: 2rem;
  border-top: 1px solid #ddd;
}

.category-tag {
  background: #c93b22;
  color: white;
  padding: 0.2rem 0.6rem;
  margin: 0.1rem;
  border-radius: 3px;
  font-size: 0.9em;
  display: inline-block;
}

.category-tag-link {
  text-decoration: none;
}

.category-tag-link:hover .category-tag {
  background: #a12e1a;
  transform: translateY(-1px);
  box-shadow: 0 2px 4px rgba(201, 59, 34, 0.3);
}

.citation-box {
  background: #f9f2f1;
  border: 1px solid #e0d6d5;
  border-radius: 5px;
  padding: 1.5rem;
  margin-bottom: 2rem;
}

.citation-box h3 {
  color: #c93b22;
  margin-top: 0;
  margin-bottom: 1rem;
  font-size: 1.2em;
}

.citation-content p {
  margin-bottom: 0.5rem;
  line-height: 1.5;
}

.doi-links {
  margin-top: 1rem;
  padding-top: 1rem;
  border-top: 1px solid #e0d6d5;
}

.doi-links p {
  margin-bottom: 0.3rem;
  font-size: 0.9em;
}

.doi-links a {
  color: #c93b22;
  text-decoration: none;
  font-family: monospace;
}

.doi-links a:hover {
  text-decoration: underline;
  color: #a12e1a;
}

.glossary-tags {
  margin-bottom: 1.5rem;
}

.tag {
  background: #f9f2f1;
  color: #c93b22;
  padding: 0.2rem 0.5rem;
  border-radius: 3px;
  font-size: 0.9em;
}

.back-to-glossary {
  color: #c93b22;
  text-decoration: none;
  font-weight: 500;
}

.back-to-glossary:hover {
  text-decoration: underline;
  color: #a12e1a;
}

/* Direct inline image styling */
.inline-image {
  display: inline;
  height: 1.2em;
  max-width: none;
  vertical-align: baseline;
  margin: 0 0.2em;
}
</style>